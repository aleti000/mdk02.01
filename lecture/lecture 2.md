# Лекция 2: Файловые системы ОС Linux

## Цели и задачи
- Изучить типы файловых систем в Linux.
- Разобраться со структурой файловой системы.
- Научиться работать с файлами и директориями.
- Понять принципы монтирования разделов и управления дисками.

## Основной материал

### 1. Что такое файловая система?
Файловая система — это способ организации и хранения данных на диске. Она определяет, как файлы и директории создаются, хранятся и удаляются.

#### Типы файловых систем в Linux:
- **ext4**: Распространенная файловая система с высокой производительностью.
- **XFS**: Подходит для работы с большими файлами (например, видео).
- **Btrfs**: Продвинутая файловая система с поддержкой снапшотов и сжатия.
- **tmpfs**: Временная файловая система, хранящая данные в оперативной памяти.

Пример:
Чтобы проверить тип файловой системы на ALT Linux, используйте команду:
df -T

### 2. Структура файловой системы Linux
Файловая система Linux организована в виде дерева. Основные директории:
- `/`: Корневая директория.
- `/home`: Домашние директории пользователей.
- `/etc`: Конфигурационные файлы.
- `/var`: Переменные данные (логи, кэш).
- `/usr`: Программы и библиотеки.
- `/dev`: Устройства (диски, принтеры).

Пример:
Чтобы посмотреть содержимое корневой директории, используйте команду:
ls /

### 3. Команды для работы с файлами и директориями
- `ls`: Просмотр содержимого директории.
- `cd`: Переход между директориями.
- `cp`: Копирование файлов.
- `mv`: Перемещение файлов.
- `rm`: Удаление файлов.
- `mkdir`: Создание директории.
- `rmdir`: Удаление пустой директории.

Пример:
Создайте новую директорию и скопируйте в нее файл:
mkdir test_dir
cp /etc/hosts test_dir/

---

### 4. Монтирование разделов: принципы работы
Монтирование — это процесс подключения раздела диска к файловой системе. Без монтирования раздел недоступен для чтения или записи.

#### Как работает монтирование:
1. **Точка монтирования**: Это директория в файловой системе, через которую можно получить доступ к данным на разделе. Например, `/mnt/usb` может быть точкой монтирования для USB-накопителя.
2. **Тип файловой системы**: При монтировании указывается тип файловой системы (например, `ext4`, `vfat` для USB).
3. **Ядро Linux**: Ядро отвечает за взаимодействие с устройствами. Когда вы монтируете раздел, ядро загружает необходимый драйвер для работы с файловой системой.

#### Команда mount:
Команда `mount` используется для подключения раздела:
mount /dev/sdb1 /mnt/usb

#### Автоматическое монтирование:
Для автоматического монтирования разделов используется файл `/etc/fstab`. В нем указываются устройства, точки монтирования и параметры.

Пример строки в `/etc/fstab`:
UUID=1234-5678 /mnt/data ext4 defaults 0 0

---

### 5. Управление дисками: принципы работы
Управление дисками включает разметку, создание разделов и форматирование.

#### Разметка диска:
Разметка — это процесс создания разделов на диске. Разделы нужны для логической организации данных.

- **MBR (Master Boot Record)**: Старый стандарт разметки, поддерживает до 4 основных разделов.
- **GPT (GUID Partition Table)**: Современный стандарт, поддерживает более 4 разделов и большие диски (>2 ТБ).

#### Утилиты для разметки:
- `fdisk`: Используется для MBR.
- `parted`: Используется для GPT.

Пример:
Создайте новый раздел с помощью `fdisk`:
fdisk /dev/sdb

#### Форматирование:
Форматирование — это процесс создания файловой системы на разделе. Команда `mkfs` используется для этого.

Пример:
Создайте файловую систему ext4:
mkfs.ext4 /dev/sdb1

#### UUID и метки:
Каждый раздел имеет уникальный идентификатор (UUID) или метку. Эти данные используются для идентификации разделов в `/etc/fstab`.

Пример:
Просмотрите UUID раздела:
blkid /dev/sdb1

---

### 6. Права доступа: принципы работы
Права доступа в Linux определяют, кто может читать, записывать или выполнять файл.

#### Как работают права:
1. **Три категории прав**:
   - Владелец (user): Пользователь, создавший файл.
   - Группа (group): Группа, которой принадлежит файл.
   - Остальные (others): Все остальные пользователи.
2. **Три типа прав**:
   - `r` (read): Чтение.
   - `w` (write): Запись.
   - `x` (execute): Выполнение.

#### Битовые значения:
Права представлены в виде чисел:
- `r` = 4
- `w` = 2
- `x` = 1

Пример:
Права `755` означают:
- Владелец: `rwx` (7 = 4 + 2 + 1)
- Группа: `r-x` (5 = 4 + 1)
- Остальные: `r-x` (5 = 4 + 1)

#### Команды:
- `chmod`: Изменяет права доступа.
- `chown`: Изменяет владельца файла.
- `chgrp`: Изменяет группу файла.

Пример:
Измените права доступа к файлу:
chmod 755 file.txt

Измените владельца файла:
chown user:group file.txt

#### SUID, SGID и Sticky Bit:
- **SUID**: Разрешает выполнение файла с правами владельца.
- **SGID**: Разрешает выполнение файла с правами группы.
- **Sticky Bit**: Защищает файлы в директории от удаления другими пользователями.

Пример:
Установите Sticky Bit на директорию:
chmod +t /tmp

---

## Домашнее задание
1. Нарисовать схему файловой системы Linux.
2. Создать новую директорию и скопировать в нее файл.
3. Проверить тип файловой системы на вашей системе.
4. Изучить команды chmod и chown.
5. Поэкспериментировать с монтированием разделов и правами доступа.

## Вопросы для самопроверки
1. Какие типы файловых систем используются в Linux?
2. Как устроена файловая система Linux?
3. Какие команды используются для работы с файлами?
4. Как подключить раздел диска к системе?
5. Как изменить права доступа к файлу?
6. Что такое UUID и как его использовать?
7. Как работают SUID, SGID и Sticky Bit?
