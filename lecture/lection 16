# Лекция 16: Безопасность Linux

## Цели и задачи
- Изучить основные принципы обеспечения безопасности операционной системы Linux.
- Разобраться с управлением пользователями, группами и правами доступа.
- Научиться настраивать файрвол для защиты системы.
- Понять процесс аудита и мониторинга системы.
- Изучить инструменты для повышения безопасности Linux.

---

## Основной материал

### 1. Введение в безопасность Linux

#### Почему важна безопасность Linux?
Linux широко используется в серверных системах, что делает его привлекательной целью для злоумышленников. Обеспечение безопасности включает:
- Защиту от несанкционированного доступа.
- Предотвращение утечек данных.
- Минимизацию рисков при эксплуатации системы.

#### Основные принципы безопасности:
1. Принцип минимальных привилегий.
2. Регулярное обновление системы.
3. Использование шифрования.
4. Аудит и мониторинг активности.

---

### 2. Управление пользователями и группами

#### Создание пользователей
Создайте нового пользователя:
useradd username

Установите пароль для пользователя:
passwd username

#### Удаление пользователей
Удалите пользователя:
userdel username

Удалите домашнюю директорию пользователя:
userdel -r username

#### Создание групп
Создайте новую группу:
groupadd groupname

Добавьте пользователя в группу:
usermod -aG groupname username

#### Просмотр информации о пользователях и группах
Просмотрите список пользователей:
cat /etc/passwd

Просмотрите список групп:
cat /etc/group

---

### 3. Управление правами доступа

#### Права доступа в Linux
Права доступа определяются для файлов и директорий:
- `r`: Чтение.
- `w`: Запись.
- `x`: Выполнение.

#### Изменение прав доступа
Измените права доступа:
chmod 755 filename

Измените владельца файла:
chown username filename

Измените группу файла:
chgrp groupname filename

#### Специальные права
- `SUID`: Разрешает выполнение файла с правами владельца.
- `SGID`: Разрешает выполнение файла с правами группы.
- `Sticky Bit`: Разрешает удаление файлов только владельцем.

Пример установки SUID:
chmod u+s filename

---

### 4. Настройка файрвола

#### Что такое файрвол?
Файрвол (межсетевой экран) — это инструмент для контроля входящего и исходящего сетевого трафика.

#### Использование `ufw`
Включите файрвол:
ufw enable

Разрешите порт:
ufw allow 22

Запретите порт:
ufw deny 80

Просмотрите статус:
ufw status

#### Использование `iptables`
Добавьте правило для разрешения трафика:
iptables -A INPUT -p tcp --dport 22 -j ACCEPT

Сохраните правила:
iptables-save > /etc/iptables/rules.v4

---

### 5. Аудит и мониторинг

#### Аудит системы
Используйте инструмент `auditd` для мониторинга активности:
auditctl -w /etc/passwd -p wa -k passwd_changes

Просмотрите логи аудита:
ausearch -k passwd_changes

#### Мониторинг логов
Просмотрите системные логи:
tail -f /var/log/syslog

Просмотрите логи аутентификации:
tail -f /var/log/auth.log

---

### 6. Шифрование данных

#### Шифрование дисков
Используйте `LUKS` для шифрования дисков:
cryptsetup luksFormat /dev/sdX

Откройте зашифрованный диск:
cryptsetup open /dev/sdX encrypted_disk

#### Шифрование файлов
Используйте `gpg` для шифрования файлов:
gpg -c filename

Расшифруйте файл:
gpg filename.gpg

---

### 7. Пример безопасной настройки системы

#### Шаги:
1. Создайте нового пользователя и назначьте ему минимальные права:
   useradd secureuser
   passwd secureuser
2. Настройте файрвол:
   ufw enable
   ufw allow 22
3. Настройте аудит для критических файлов:
   auditctl -w /etc/passwd -p wa -k passwd_changes
4. Зашифруйте важные данные:
   gpg -c important_file.txt

---

## Домашнее задание
1. Создайте нового пользователя и назначьте ему минимальные права.
2. Настройте файрвол для разрешения только необходимых портов.
3. Настройте аудит для критических файлов (например, `/etc/passwd`).
4. Зашифруйте файл с помощью `gpg`.
5. Изучите логи системы и найдите записи о подозрительной активности.

---

## Вопросы для самопроверки
1. Почему важна безопасность Linux?
2. Как управлять пользователями и группами в Linux?
3. Как настроить права доступа для файлов и директорий?
4. Как использовать файрвол для защиты системы?
5. Какие инструменты можно использовать для аудита и мониторинга системы?
